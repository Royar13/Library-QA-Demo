{"version":3,"sources":["app.js","addReader/addReader.js","directives/error.js","login/login.js","main/main.js","panel/panel.js","services/user.js","topBar/topBar.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACpBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACrCA;AACA;AACA;AACA;ACHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AChCA;AACA;ACDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"script.js","sourcesContent":["var app = angular.module(\"library\", [\"ngRoute\"]);\r\napp.config(function ($routeProvider) {\r\n    $routeProvider\r\n            .when(\"/\", {\r\n                templateUrl: \"app/login/login.html\",\r\n                controller: \"loginCtrl\"\r\n            })\r\n            .when(\"/main\", {\r\n                templateUrl: \"app/main/main.html\",\r\n                controller: \"mainCtrl\"\r\n            })\r\n            .when(\"/addReader\", {\r\n                templateUrl: \"app/addReader/addReader.html\",\r\n                controller: \"addReaderCtrl\"\r\n            });\r\n}).run(function ($rootScope, $location) {\r\n    $rootScope.$on(\"$routeChangeSuccess\", function (event, data) {\r\n        if (data.$$route && data.$$route.controller)\r\n            $rootScope.controllerName = data.$$route.controller;\r\n    });\r\n});","angular.module(\"library\").controller(\"addReaderCtrl\", function ($scope, $http) {\r\n    $scope.fields = {\r\n        id: \"\",\r\n        name: \"\",\r\n        city: \"\",\r\n        street: \"\",\r\n        maxBooks: 0,\r\n        readerType: \"\"\r\n    };\r\n    $scope.monthlyPay = function () {\r\n        try {\r\n            var pay = getReaderType($scope.fields.readerType).bookCost * $scope.fields.maxBooks;\r\n            return pay;\r\n        }\r\n        catch (err) {\r\n            return 0;\r\n        }\r\n    };\r\n    function getReaderType(id) {\r\n        for (var i in $scope.readerTypes) {\r\n            if ($scope.readerTypes[i].id == id)\r\n                return $scope.readerTypes[i];\r\n        }\r\n    }\r\n    $http({\r\n        method: \"post\",\r\n        url: \"./server/getReaderTypes.php\"\r\n    }).then(function (response) {\r\n        $scope.readerTypes = response.data.readerTypes;\r\n    });\r\n    $http({\r\n        method: \"post\",\r\n        url: \"./server/getBooksNum.php\"\r\n    }).then(function (response) {\r\n        $scope.maxBooks = response.data.booksNum;\r\n    });\r\n});\r\n","angular.module(\"library\").directive(\"error\", function () {\n    return {\n    };\n});","angular.module(\"library\").controller(\"loginCtrl\", function ($scope, $http, userService, $location) {\r\n    var request = userService.getUser();\r\n    if (request === true) {\r\n        $location.path(\"/main\");\r\n    } else {\r\n        request.then(function () {\r\n            if (userService.user != null)\r\n                $location.path(\"/main\");\r\n        });\r\n    }\r\n    $scope.fields = {\r\n        username: \"\",\r\n        password: \"\"\r\n    };\r\n    $scope.errors = {};\r\n    $scope.loading = false;\r\n    $scope.login = function () {\r\n        $scope.loading = true;\r\n        $http({\r\n            method: \"post\",\r\n            url: \"./server/login.php\",\r\n            data: $scope.fields\r\n        }).then(function (response) {\r\n            $scope.loading = false;\r\n            if (response.data.success) {\r\n                userService.updateUser(response.data.username, response.data.name);\r\n                $location.path(\"/main\");\r\n            } else {\r\n                $scope.errors = response.data.errors;\r\n            }\r\n        });\r\n    };\r\n});","angular.module(\"library\").controller(\"mainCtrl\", function ($scope) {\r\n});","angular.module(\"library\").controller(\"panelCtrl\", function ($scope, $window) {\r\n    var bgRatio = 1.67;\r\n    var bgWidth = $(window).height() * bgRatio;\r\n    var leftMargin = ($(window).width() - bgWidth) / 2;\r\n    $scope.panelStyle = {};\r\n    $scope.panelStyle.right = Math.max(leftMargin + 20, 20);\r\n    //$scope.panelStyle.width = bgWidth * 0.7;\r\n    //$scope.panelStyle.height = $(window).height() * 0.8;\r\n\r\n    $scope.back = function () {\r\n        $window.history.back();\r\n    };\r\n});","angular.module(\"library\").service(\"userService\", function ($http, $location) {\r\n    this.updateUser = function (username, name) {\r\n        this.user = {username: username, name: name};\r\n    };\r\n    this.getUser = function () {\r\n        if (this.user != null) {\r\n            return true;\r\n        }\r\n        var _this = this;\r\n        return $http({\r\n            method: \"post\",\r\n            url: \"./server/login.php\"\r\n        }).then(function (response) {\r\n            if (response.data.success) {\r\n                _this.updateUser(response.data.username, response.data.name);\r\n            }\r\n        });\r\n    };\r\n});","angular.module(\"library\").controller(\"topBarCtrl\", function ($scope, $http, $location, userService) {\r\n    $scope.user = {};\r\n    function retrieveUser() {\r\n        Object.keys(userService.user).forEach(function (key) {\r\n            $scope.user[key] = userService.user[key];\r\n        });\r\n    }\r\n    ;\r\n    var request = userService.getUser();\r\n    if (request === true) {\r\n        retrieveUser();\r\n    } else {\r\n        request.then(function () {\r\n            if (userService.user != null)\r\n                retrieveUser();\r\n            else\r\n                $location.path(\"/\");\r\n        });\r\n    }\r\n    $scope.disconnect = function () {\r\n        $http({\r\n            method: \"post\",\r\n            url: \"./server/disconnect.php\"\r\n        }).then(function () {\r\n            userService.user = null;\r\n            $location.path(\"/\");\r\n        });\r\n    };\r\n});"],"sourceRoot":"/source/"}